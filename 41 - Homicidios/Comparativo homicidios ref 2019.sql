SELECT UEOP, MUNICIPIO,


sum(case
when data_fato between '2019-01-01' and '2019-12-31' then 1 else 0 -- 2019

end) as '2019',


sum(case
when data_fato between '2019-01-01' and DATE_SUB(DATE_SUB(CURDATE(), INTERVAL 1 year), INTERVAL 1 DAY) then 1 else 0 -- 2019
end) as '2019P'


from gdo.tbl_homicidios_2019_ref


where data_fato between '2019-01-01' and '2019-12-31'

and (( -- INÍCIO CONDIÇÃO PRINCIPAL		
				(COD_DIAO in ('B01121') and T_C = 'CONSUMADO')	  
				or  COD_DELITO in ('B01121') and T_C_DELITO = 'CONSUMADO')
                or NREDS IN ('2019-004900113-001')
			) -- FIM CONDIÇÃO PARA  (NATUREZAS)

and GRAU_LESAO = 'FATAL'

and GRUPO_TIPO_ENVOL = 'VITIMA'

and NREDS in ('2019-035286440-001', '2019-024759037-001', '2019-025467724-001', '2019-053612768-001', '2019-038455930-001', '2019-051796235-001', '2019-001499135-001', '2019-004860740-001', '2019-058973901-001', '2019-044603829-001', '2019-045470060-001', '2019-003687112-001', '2019-031284170-001', '2019-004031104-001', '2019-003951001-001', '2019-051889409-001', '2019-063229075-001', '2019-015875680-001', '2019-017770188-001', '2019-052752979-001', '2019-024596318-001', '2019-055172813-001', '2019-017215552-001', '2019-047524362-001', '2019-053952940-001', '2019-047167306-001', '2019-058841483-001', '2019-042346952-001', '2019-007891805-002', '2019-007140510-001', '2019-012236614-001', '2019-052546979-001', '2019-018455870-001', '2019-008986756-001', '2019-014051718-001', '2019-001683345-001', '2019-023906031-001', '2019-017057093-001', '2019-005045419-001', '2019-010447049-001', '2019-001502171-001', '2019-025920917-001', '2019-036059587-001', '2019-026917560-001', '2019-051328347-001', '2019-012454242-001', '2019-005093291-001', '2019-022956282-001', '2019-021553035-001', '2019-030889630-001', '2019-058935833-001', '2019-018560685-001', '2019-013379930-001', '2019-012219435-001', '2019-058839456-001', '2019-034579741-001', '2019-011470172-001', '2019-017242241-001', '2019-029238547-001', '2019-026332109-001', '2019-023548093-001', '2019-057818860-001', '2019-003054638-001', '2019-063799818-001', '2019-042688833-001', '2019-007891805-001', '2019-055650752-001', '2019-052351981-001', '2019-060340314-001', '2019-060338540-001', '2019-000426766-001', '2019-038093100-001', '2019-029715531-001', '2019-048989373-001', '2019-033472840-001', '2019-052802560-001', '2019-039654779-001', '2019-015442763-001', '2019-063799818-001', '2019-034384782-001', '2019-045656749-001', '2019-055410115-001', '2019-049589648-001', '2019-057536484-001', '2019-007613563-001', '2019-062776164-001', '2019-026718167-001', '2019-005750927-001', '2019-017352767-001', '2019-050878953-001', '2019-044032130-001', '2019-036785809-001', '2019-053348790-001', '2019-001802010-001', '2019-033990449-001', '2019-016099240-001', '2019-002987785-001', '2019-003944852-001', '2019-001703100-001', '2019-062903388-001', '2019-023280061-001', '2019-011197975-001', '2019-050402517-001', '2019-051194764-001', '2019-016904340-001', '2019-034579741-001', '2019-046202080-001', '2019-019813766-001', '2019-061193911-001', '2019-010968770-001', '2019-017195155-001', '2019-000677394-001', '2019-059147113-001', '2019-051173940-001', '2019-041083170-001', '2019-034829427-001', '2019-003182579-001', '2019-029328037-001', '2019-011120778-001', '2019-055815470-001', '2019-046347235-001', '2019-034223055-001', '2019-015619642-001', '2019-008347973-001', '2019-023462859-001', '2019-000423671-001', '2019-048662800-001', '2019-007116067-001', '2019-002288679-001', '2019-022782009-001', '2019-032273201-002', '2019-011196275-001', '2019-005887596-001', '2019-024434770-001', '2019-008139002-001', '2019-007786771-001', '2019-042991250-001', '2019-000105837-001', '2019-058498615-001', '2019-012337903-001', '2019-006451434-001', '2019-050059928-001', '2019-044582862-001', '2019-017556467-001', '2019-047664399-001', '2019-038111370-001', '2019-001520747-001', '2019-060260622-001', '2019-019543882-001', '2019-043639327-001', '2019-046758061-001', '2019-041157363-001', '2019-014635770-001', '2019-055239471-001', '2019-000713270-001', '2019-004048130-001', '2019-004900113-001')

and NREDS not in ('2019-007891805-002', '2019-007116067-001', '2019-055650752-001')


-- AND NREDS IN ('2019-004048130-001')

group by MUNICIPIO   with rollup
;